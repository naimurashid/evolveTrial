% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation_driver.R
\name{run_simulation_pure}
\alias{run_simulation_pure}
\title{Run a full set of evolveTrial simulations for a design specification}
\usage{
run_simulation_pure(
  num_simulations,
  arm_names,
  reference_arm_name,
  compare_arms_option,
  weibull_shape_true_arms,
  weibull_median_true_arms,
  null_median_arms,
  futility_median_arms,
  interval_cutpoints_sim,
  max_follow_up_sim,
  censor_max_time_sim,
  prior_alpha_params_model,
  prior_beta_params_model,
  num_posterior_draws,
  num_posterior_draws_interim = NULL,
  cohort_size_per_arm,
  max_total_patients_per_arm,
  min_patients_for_analysis,
  efficacy_stopping_rule_hc,
  efficacy_threshold_current_prob_hc,
  posterior_futility_threshold_hc,
  futility_stopping_rule_hc,
  efficacy_stopping_rule_vs_ref,
  futility_stopping_rule_vs_ref,
  efficacy_threshold_vs_ref_prob,
  futility_threshold_vs_ref_prob,
  compare_arms_futility_margin,
  compare_arms_hr_margin = NULL,
  use_ph_model_vs_ref = FALSE,
  ph_loghr_prior_mean = 0,
  ph_loghr_prior_sd = 1,
  median_pfs_success_threshold_arms,
  final_success_posterior_prob_threshold,
  median_pfs_futility_threshold_arms,
  final_futility_posterior_prob_threshold,
  overall_accrual_rate,
  randomization_probs,
  min_follow_up_at_final = 0,
  min_events_for_analysis = 0,
  min_median_followup = 0,
  interim_calendar_beat = 2,
  diagnostics = FALSE,
  pred_success_pp_threshold_hc,
  pred_futility_pp_threshold_hc,
  num_posterior_draws_pred,
  predictive_fast = FALSE,
  min_events_per_arm = NULL,
  min_median_followup_per_arm = NULL,
  min_person_time_frac_per_arm = 0,
  person_time_milestones = NULL,
  latest_calendar_look = Inf,
  rebalance_after_events = NULL,
  parallel_replicates = FALSE,
  num_workers = NULL,
  cluster_type = c("PSOCK", "FORK"),
  progress = interactive()
)
}
\arguments{
\item{num_simulations}{Number of Monte Carlo replicates to run.}

\item{arm_names}{Character vector naming the trial arms.}

\item{reference_arm_name}{Character scalar naming the control/reference arm.}

\item{compare_arms_option}{Logical; \code{TRUE} evaluates vs-reference logic,
\code{FALSE} evaluates arms independently against historical control targets.}

\item{weibull_shape_true_arms}{Named numeric vector of Weibull shape
parameters under the truth.}

\item{weibull_median_true_arms}{Named numeric vector of true median PFS
(months) for each arm.}

\item{null_median_arms}{Named numeric vector of null (historical control)
medians used for single-arm evaluations.}

\item{futility_median_arms}{Named numeric vector of futility medians for
single-arm logic.}

\item{interval_cutpoints_sim}{Numeric vector of interval boundaries (months)
for piecewise exponential modelling.}

\item{max_follow_up_sim}{Maximum administrative follow-up time (months).}

\item{censor_max_time_sim}{Upper bound for random censoring draws (months).}

\item{prior_alpha_params_model}{Numeric vector of Gamma prior shape
parameters for the piecewise exponential hazards.}

\item{prior_beta_params_model}{Numeric vector of Gamma prior rate parameters
for the piecewise exponential hazards.}

\item{num_posterior_draws}{Number of posterior draws used for final analyses.}

\item{num_posterior_draws_interim}{Optional integer overriding the number of
posterior draws used at interim looks.}

\item{cohort_size_per_arm}{Size of each enrolment batch per arm (typically 1).}

\item{max_total_patients_per_arm}{Named integer vector of per-arm sample size
caps.}

\item{min_patients_for_analysis}{Minimum number of patients required to
evaluate an arm in the single-arm path.}

\item{efficacy_stopping_rule_hc}{Logical; enable interim efficacy checks for
the historical-control path.}

\item{efficacy_threshold_current_prob_hc}{Interim success probability
threshold for single-arm logic.}

\item{posterior_futility_threshold_hc}{Interim futility probability threshold
for single-arm logic.}

\item{futility_stopping_rule_hc}{Logical; enable interim futility checks for
the single-arm path.}

\item{efficacy_stopping_rule_vs_ref}{Logical; enable interim efficacy checks
for the vs-reference path.}

\item{futility_stopping_rule_vs_ref}{Logical; enable interim futility checks
for the vs-reference path.}

\item{efficacy_threshold_vs_ref_prob}{Posterior superiority threshold for
vs-reference decisions.}

\item{futility_threshold_vs_ref_prob}{Posterior inferiority threshold for
vs-reference decisions.}

\item{compare_arms_futility_margin}{Absolute median difference used when
defining vs-reference futility.}

\item{compare_arms_hr_margin}{Optional hazard-ratio margin used when
\code{use_ph_model_vs_ref = TRUE}.}

\item{use_ph_model_vs_ref}{Logical; use the proportional-hazards joint model
for vs-reference comparisons.}

\item{ph_loghr_prior_mean}{Mean of the normal prior on the log hazard ratio
(PH model).}

\item{ph_loghr_prior_sd}{Standard deviation of the normal prior on the log
hazard ratio.}

\item{median_pfs_success_threshold_arms}{Named numeric vector of median PFS
thresholds for declaring final success per arm.}

\item{final_success_posterior_prob_threshold}{Posterior probability threshold
for final success declarations.}

\item{median_pfs_futility_threshold_arms}{Named numeric vector of median PFS
futility thresholds for final analyses.}

\item{final_futility_posterior_prob_threshold}{Posterior probability
threshold for final futility declarations.}

\item{overall_accrual_rate}{Expected accrual rate (patients per month).}

\item{randomization_probs}{Named numeric vector of randomisation probabilities.}

\item{min_follow_up_at_final}{Additional follow-up (months) required after
last enrolment before the final analysis.}

\item{min_events_for_analysis}{Minimum events required for interim review
(global gate).}

\item{min_median_followup}{Minimum median follow-up required for interim
review (global gate).}

\item{interim_calendar_beat}{Calendar spacing (months) between scheduled
interim looks when person-time milestones are not used.}

\item{diagnostics}{Logical; if \code{TRUE} prints interim diagnostic messages.}

\item{pred_success_pp_threshold_hc}{Predictive probability threshold for
interim success in the single-arm predictive look (if enabled).}

\item{pred_futility_pp_threshold_hc}{Predictive probability threshold for
interim futility in the single-arm predictive look (if enabled).}

\item{num_posterior_draws_pred}{Number of posterior draws used inside
predictive probability calculations.}

\item{predictive_fast}{Logical; switch to the analytic predictive
approximations.}

\item{min_events_per_arm}{Optional per-arm minimum event gate for vs-reference.}

\item{min_median_followup_per_arm}{Optional per-arm minimum median follow-up
gate for vs-reference.}

\item{min_person_time_frac_per_arm}{Optional per-arm proportion of planned
person-time required before evaluating vs-reference decisions.}

\item{person_time_milestones}{Optional numeric vector (fractions of total
planned person-time) triggering interim looks.}

\item{latest_calendar_look}{Backstop calendar time for person-time schedules.}

\item{rebalance_after_events}{Optional integer; when non-\code{NULL} the piecewise
cut points are re-estimated once that number of events has accrued.}

\item{parallel_replicates}{Logical; if \code{TRUE}, distribute Monte Carlo
replicates across a parallel cluster (PSOCK by default).}

\item{num_workers}{Optional integer specifying the number of workers when
\code{parallel_replicates = TRUE}. Defaults to \code{parallel::detectCores() - 1}.}

\item{cluster_type}{Type of parallel cluster to spawn when distributing
replicates. One of \code{"PSOCK"} (default) or \code{"FORK"}.}

\item{progress}{Logical; show the simulation progress bar when running
sequentially. Automatically disabled for parallel replicate execution.}
}
\value{
A data frame with one row per arm and columns summarising operating
characteristics such as type I error / power, PETs, final decision
probabilities, and expected sample size.
}
\description{
\code{run_simulation_pure()} is the workhorse simulator for evolveTrial.  It
enrols patients according to the supplied accrual plan, applies interim
gating/decision rules, optionally rebalances interval cut points, and
carries each replicate forward to the final analysis.  Operating
characteristics are returned summarised per arm.
}
\details{
When \code{parallel_replicates = TRUE}, results will vary based on
\code{num_workers} due to different random number stream partitioning.
For exact reproducibility across runs, use \code{parallel_replicates = FALSE}.

During package development with \code{devtools::load_all()}, parallel workers
will load the installed package version, not the development code. For
testing development changes, either use \code{parallel_replicates = FALSE} or
reinstall the package with \code{devtools::install()}.
}
